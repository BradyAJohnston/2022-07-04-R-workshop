{
  "hash": "a80af2b065ac3ca5944464270f02fad4",
  "result": {
    "markdown": "---\ntitle: \"Stats in R\"\nauthor: \"Brady Johnston\"\neditor: visual\ncallout-icon: false\n---\n\n\n::: callout-note\n## Learning Objectives\n\n-   Learn some stats!\n:::\n\n-   Numerical summaries of variables (incl. assigning/changing factor levels, setting thresholds, missing data, identifying outliers)\n\n-   Assumptions for specific tests (incl. normality)\n\n-   Tests: chi-squared, t-test, one-way ANOVA, two-way ANOVA, correlations/regressions, and corresponding non-parametric tests\n\n-   Effect size/Power\\\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n✔ ggplot2 3.3.6     ✔ purrr   0.3.4\n✔ tibble  3.1.7     ✔ dplyr   1.0.9\n✔ tidyr   1.2.0     ✔ stringr 1.4.0\n✔ readr   2.1.2     ✔ forcats 0.5.1\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n```\n:::\n\n```{.r .cell-code}\n# chi-squared\n# t-test\nt.test(rnorm(100), mu = 0) |> summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Length Class  Mode     \nstatistic   1      -none- numeric  \nparameter   1      -none- numeric  \np.value     1      -none- numeric  \nconf.int    2      -none- numeric  \nestimate    1      -none- numeric  \nnull.value  1      -none- numeric  \nstderr      1      -none- numeric  \nalternative 1      -none- character\nmethod      1      -none- character\ndata.name   1      -none- character\n```\n:::\n\n```{.r .cell-code}\nt.test(rnorm(100), mu = 10) |> summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Length Class  Mode     \nstatistic   1      -none- numeric  \nparameter   1      -none- numeric  \np.value     1      -none- numeric  \nconf.int    2      -none- numeric  \nestimate    1      -none- numeric  \nnull.value  1      -none- numeric  \nstderr      1      -none- numeric  \nalternative 1      -none- character\nmethod      1      -none- character\ndata.name   1      -none- character\n```\n:::\n\n```{.r .cell-code}\n# one-way ANOVA\n# two-way ANOVA\naov(iris$Petal.Width ~ iris$Species, )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCall:\n   aov(formula = iris$Petal.Width ~ iris$Species)\n\nTerms:\n                iris$Species Residuals\nSum of Squares      80.41333   6.15660\nDeg. of Freedom            2       147\n\nResidual standard error: 0.20465\nEstimated effects may be unbalanced\n```\n:::\n\n```{.r .cell-code}\naov(Petal.Width ~ Species, data = iris)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCall:\n   aov(formula = Petal.Width ~ Species, data = iris)\n\nTerms:\n                 Species Residuals\nSum of Squares  80.41333   6.15660\nDeg. of Freedom        2       147\n\nResidual standard error: 0.20465\nEstimated effects may be unbalanced\n```\n:::\n\n```{.r .cell-code}\niris.aov <- aov(iris$Petal.Width ~ iris$Species)\n# Summarise the ANOVA results\nsummary(iris.aov)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n              Df Sum Sq Mean Sq F value Pr(>F)    \niris$Species   2  80.41   40.21     960 <2e-16 ***\nResiduals    147   6.16    0.04                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\n# correlations/regressions\ncor.test(cars$speed, cars$dist)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPearson's product-moment correlation\n\ndata:  cars$speed and cars$dist\nt = 9.464, df = 48, p-value = 1.49e-12\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.6816422 0.8862036\nsample estimates:\n      cor \n0.8068949 \n```\n:::\n\n```{.r .cell-code}\nlm(speed ~ dist, data = cars) |> \n  summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = speed ~ dist, data = cars)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-7.5293 -2.1550  0.3615  2.4377  6.4179 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  8.28391    0.87438   9.474 1.44e-12 ***\ndist         0.16557    0.01749   9.464 1.49e-12 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3.156 on 48 degrees of freedom\nMultiple R-squared:  0.6511,\tAdjusted R-squared:  0.6438 \nF-statistic: 89.57 on 1 and 48 DF,  p-value: 1.49e-12\n```\n:::\n\n```{.r .cell-code}\n# corresponding non-parametric tests\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- palmerpenguins::penguins\n# library(tidyverse)\ndf |> \n  drop_na(bill_length_mm) |> \n  group_by(species) |> \n  nest() |> \n  mutate(\n    test = map(data, ~t.test(.x$bill_length_mm, .x$bill_depth_mm)), \n    values = map(test, broom::tidy)\n  ) |> \n  unnest(values)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 13\n# Groups:   species [3]\n  species   data     test    estimate estimate1 estimate2 statistic   p.value\n  <fct>     <list>   <list>     <dbl>     <dbl>     <dbl>     <dbl>     <dbl>\n1 Adelie    <tibble> <htest>     20.4      38.8      18.3      85.8 1.87e-165\n2 Gentoo    <tibble> <htest>     32.5      47.5      15.0     112.  1.48e-143\n3 Chinstrap <tibble> <htest>     30.4      48.8      18.4      71.1 1.18e- 75\n# … with 5 more variables: parameter <dbl>, conf.low <dbl>, conf.high <dbl>,\n#   method <chr>, alternative <chr>\n```\n:::\n:::\n\n\n\\\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\ndf <- readxl::read_excel(\"data_raw/example_cell_data.xlsx\")\n\nReplicateAverages <-\n  df %>% \n  group_by(Treatment, Replicate) %>% \n  summarise(Speed = mean(Speed))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'Treatment'. You can override using the\n`.groups` argument.\n```\n:::\n\n```{.r .cell-code}\nggplot(df, aes(\n  x = Treatment,\n  y = Speed,\n  color = factor(Replicate)\n)) + \n  ggbeeswarm::geom_beeswarm(cex = 1.5, alpha = 0.3) + \n  scale_colour_brewer(palette = \"Set1\") + \n  stat_summary(\n    geom  = \"point\", \n    fun = mean, \n    shape = 21, \n    mapping = aes(fill = factor(Replicate)), \n    colour = \"black\", \n    alpha = 1, \n    size = 8\n  ) + \n  ggpubr::stat_compare_means(\n    data = ReplicateAverages,\n    comparisons = list(c(\"Control\", \"Drug\")),\n    method = \"t.test\",\n    paired = TRUE, \n    label = \"p.value\"\n  ) +\n  theme_classic(base_size = 20) + \n  theme(legend.position = \"none\") + \n  labs(\n    title = \"Comparison of Cell Response\"\n  )\n```\n\n::: {.cell-output-display}\n![](stats_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "stats_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}